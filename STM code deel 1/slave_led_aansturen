#include <Wire.h>

#define SDA PB7
#define SCL PB6
#define LED_PIN PA11
#define SLAVE_ADDRESS 0x13

void setup() {
    Wire.setSDA(SDA);
    Wire.setSCL(SCL);
    
    Serial.begin(115200);
    Serial.println("STM32 I2C Slave met LED");

    Wire.begin(SLAVE_ADDRESS);
    
    pinMode(LED_PIN, OUTPUT);
    
    // Functie voor ontvangen data van de master
    Wire.onReceive(receiveEvent);
}

void loop() {
    delay(100);  // Wacht op commando's van de master
}

// Functie wordt aangeroepen als de master data stuurt
void receiveEvent(int bytes) {
    if (Wire.available()) {
        char command = Wire.read();  // Lees het ontvangen commando
        Serial.print("Ontvangen commando: ");
        Serial.println(command);

        if (command == '1') {
            Serial.println("LED AAN!");
            digitalWrite(LED_PIN, HIGH);
        } else if (command == '0') {
            Serial.println("LED UIT!");
            digitalWrite(LED_PIN, LOW);
        }
    }
}
